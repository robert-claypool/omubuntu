# omubuntu managed ZSH configuration
# This file is owned by omubuntu and may be updated automatically.
# Customize your shell by editing ~/.zshrc (the user stub), not this file.

# Helper: check if a command exists
have() { command -v "$1" >/dev/null 2>&1 }

# oh-my-zsh configuration
export ZSH="$HOME/.oh-my-zsh"

# Theme: disabled (using starship prompt instead)
ZSH_THEME=""

# Plugins: practical, mainstream choices
# NOTE: zsh-syntax-highlighting should be last.
plugins=(
  git
  sudo
  zsh-completions
  zsh-autosuggestions
  zsh-syntax-highlighting
)

# Load oh-my-zsh if installed
[[ -f "$ZSH/oh-my-zsh.sh" ]] && source "$ZSH/oh-my-zsh.sh"

# History
HISTFILE=~/.zsh_history
HISTSIZE=50000
SAVEHIST=50000
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE

# Aliases (guarded so the shell still works if a tool is missing)
if have eza; then
  alias ls='eza --icons'
  alias ll='eza -la --icons --git'
  alias la='eza -a --icons'
  alias lt='eza --tree --icons'
fi

if have bat; then
  alias cat='bat --paging=never'
fi

# Git aliases (supplements oh-my-zsh git plugin)
alias g='git'
alias gs='git status'
alias gd='git diff'
alias gl='git log --oneline -20'
alias gp='git pull'
alias gc='git commit'
alias gco='git checkout'
alias gb='git branch'

# Tool aliases (guarded)
if have nvim; then
  alias vim='nvim'
  alias v='nvim'
fi

if have lazygit; then
  alias lg='lazygit'
fi

if have claude; then
  alias c='claude'
fi

# Initialize tools (guarded)
if have zoxide; then
  eval "$(zoxide init zsh)"
fi

if have direnv; then
  eval "$(direnv hook zsh)"
fi

if have atuin; then
  eval "$(atuin init zsh)" 2>/dev/null || true
fi

# FZF integration
[[ -f /usr/share/doc/fzf/examples/key-bindings.zsh ]] && source /usr/share/doc/fzf/examples/key-bindings.zsh
[[ -f /usr/share/doc/fzf/examples/completion.zsh ]] && source /usr/share/doc/fzf/examples/completion.zsh

# PATH - include common tool install locations
export PATH="$HOME/.bun/bin:$HOME/.local/bin:$PATH"

# Editor
export EDITOR="nvim"
export VISUAL="nvim"

# Starship prompt (must be last)
if have starship; then
  export STARSHIP_CONFIG="$HOME/.config/omubuntu/starship.toml"
  eval "$(starship init zsh)"
fi